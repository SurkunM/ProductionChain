"use strict";(self["webpackChunkfrontend"]=self["webpackChunkfrontend"]||[]).push([[808],{7808:function(t,e,s){s.r(e),s.d(e,{default:function(){return u}});var o=s(6768),r=s(5130),i=s(4232);const a=["onClick"];function l(t,e,s,l,c,n){const d=(0,o.g2)("v-icon"),u=(0,o.g2)("v-btn"),m=(0,o.g2)("v-text-field"),h=(0,o.g2)("v-chip"),g=(0,o.g2)("v-data-table"),k=(0,o.g2)("v-card-title"),p=(0,o.g2)("v-card-text"),v=(0,o.g2)("v-card"),_=(0,o.g2)("v-col"),C=(0,o.g2)("v-row"),f=(0,o.g2)("v-container"),y=(0,o.g2)("v-pagination");return(0,o.uX)(),(0,o.Wv)(v,{title:"Очередь производства",flat:""},{text:(0,o.k6)((()=>[(0,o.bF)(m,{modelValue:c.term,"onUpdate:modelValue":e[0]||(e[0]=t=>c.term=t),label:"Найти",autocomplete:"off","prepend-inner-icon":"mdi-magnify",variant:"outlined","hide-details":"","single-line":"",onKeyup:(0,r.jR)(n.search,["enter"])},{"append-inner":(0,o.k6)((()=>[(0,o.bF)(u,{icon:"",onClick:n.search,color:"primary",size:"small"},{default:(0,o.k6)((()=>[(0,o.bF)(d,null,{default:(0,o.k6)((()=>e[8]||(e[8]=[(0,o.eW)("mdi-magnify")]))),_:1,__:[8]})])),_:1},8,["onClick"]),(0,o.bF)(d,{onClick:n.cancelSearch,style:{cursor:"pointer"},size:"x-large",class:"ms-1 me-2"},{default:(0,o.k6)((()=>e[9]||(e[9]=[(0,o.eW)(" mdi-close-circle ")]))),_:1,__:[9]},8,["onClick"])])),_:1},8,["modelValue","onKeyup"])])),default:(0,o.k6)((()=>[n.isAuthorized?((0,o.uX)(),(0,o.Wv)(g,{key:0,headers:c.headers,items:n.productionOrders,loading:n.isLoading,"hide-default-footer":"","items-per-page":n.itemsPerPage,"no-data-text":"Список пуст"},{["header.name"]:(0,o.k6)((({column:t})=>[(0,o.Lk)("button",{onClick:e[1]||(e[1]=t=>n.sortBy("product.Name"))},(0,i.v_)(t.title),1),c.sortByColumn===t.value?((0,o.uX)(),(0,o.Wv)(d,{key:0},{default:(0,o.k6)((()=>[(0,o.eW)((0,i.v_)(c.sortDesc?"mdi-menu-up":"mdi-menu-down"),1)])),_:1})):(0,o.Q3)("",!0)])),["header.inProgressCount"]:(0,o.k6)((({column:t})=>[(0,o.Lk)("button",{onClick:e[2]||(e[2]=t=>n.sortBy("inProgressProductsCount"))},(0,i.v_)(t.title),1),c.sortByColumn===t.value?((0,o.uX)(),(0,o.Wv)(d,{key:0},{default:(0,o.k6)((()=>[(0,o.eW)((0,i.v_)(c.sortDesc?"mdi-menu-up":"mdi-menu-down"),1)])),_:1})):(0,o.Q3)("",!0)])),["header.completedCount"]:(0,o.k6)((({column:t})=>[(0,o.Lk)("button",{onClick:e[3]||(e[3]=t=>n.sortBy("completedProductsCount"))},(0,i.v_)(t.title),1),c.sortByColumn===t.value?((0,o.uX)(),(0,o.Wv)(d,{key:0},{default:(0,o.k6)((()=>[(0,o.eW)((0,i.v_)(c.sortDesc?"mdi-menu-up":"mdi-menu-down"),1)])),_:1})):(0,o.Q3)("",!0)])),["header.totalCount"]:(0,o.k6)((({column:t})=>[(0,o.Lk)("button",{onClick:e[4]||(e[4]=t=>n.sortBy("totalProductsCount"))},(0,i.v_)(t.title),1),c.sortByColumn===t.value?((0,o.uX)(),(0,o.Wv)(d,{key:0},{default:(0,o.k6)((()=>[(0,o.eW)((0,i.v_)(c.sortDesc?"mdi-menu-up":"mdi-menu-down"),1)])),_:1})):(0,o.Q3)("",!0)])),["header.status"]:(0,o.k6)((({column:t})=>[(0,o.Lk)("button",{onClick:e=>n.sortBy(t.status)},(0,i.v_)(t.title),9,a),c.sortByColumn===t.value?((0,o.uX)(),(0,o.Wv)(d,{key:0},{default:(0,o.k6)((()=>[(0,o.eW)((0,i.v_)(c.sortDesc?"mdi-menu-up":"mdi-menu-down"),1)])),_:1})):(0,o.Q3)("",!0)])),["item.status"]:(0,o.k6)((({value:t,item:e})=>[(0,o.bF)(h,{border:`${n.getColor(t)} thin opacity-25`,color:n.getColor(t),text:e.statusMap,size:"small"},null,8,["border","color","text"])])),["item.actions"]:(0,o.k6)((({item:t})=>[t.completedCount<t.totalCount?((0,o.uX)(),(0,o.Wv)(u,{key:0,size:"small",color:"info",onClick:e[5]||(e[5]=t=>n.showTaskCreateModal()),class:"mt-2"},{default:(0,o.k6)((()=>e[10]||(e[10]=[(0,o.eW)("Создать задачу")]))),_:1,__:[10]})):(0,o.Q3)("",!0),(0,o.bF)(u,{size:"small",color:"error",onClick:e=>n.endProductionOrder(t),class:"my-2"},{default:(0,o.k6)((()=>e[11]||(e[11]=[(0,o.eW)("Завершить заказ")]))),_:2,__:[11]},1032,["onClick"])])),_:2},1032,["headers","items","loading","items-per-page"])):((0,o.uX)(),(0,o.Wv)(f,{key:1,class:"fill-height",fluid:""},{default:(0,o.k6)((()=>[(0,o.bF)(C,{align:"center",justify:"center"},{default:(0,o.k6)((()=>[(0,o.bF)(_,{cols:"12",sm:"8",md:"6",lg:"4"},{default:(0,o.k6)((()=>[(0,o.bF)(v,{class:"text-center pa-8"},{default:(0,o.k6)((()=>[(0,o.bF)(d,{size:"64",color:"grey-lighten-1",class:"mb-4"},{default:(0,o.k6)((()=>e[12]||(e[12]=[(0,o.eW)(" mdi-account-lock ")]))),_:1,__:[12]}),(0,o.bF)(k,{class:"text-h5 justify-center"},{default:(0,o.k6)((()=>e[13]||(e[13]=[(0,o.eW)(" Требуется авторизация ")]))),_:1,__:[13]}),(0,o.bF)(p,null,{default:(0,o.k6)((()=>[e[15]||(e[15]=(0,o.Lk)("p",{class:"text-body-1 mb-4"}," Для просмотра этой страницы необходимо войти в систему ",-1)),(0,o.bF)(u,{color:"primary",onClick:e[6]||(e[6]=t=>n.showLoginModal())},{default:(0,o.k6)((()=>e[14]||(e[14]=[(0,o.eW)(" Войти ")]))),_:1,__:[14]})])),_:1,__:[15]})])),_:1})])),_:1})])),_:1})])),_:1})),(0,o.bF)(y,{modelValue:c.currentPage,"onUpdate:modelValue":[e[7]||(e[7]=t=>c.currentPage=t),n.switchPage],length:n.pagesCount,circle:"",color:"primary"},null,8,["modelValue","length","onUpdate:modelValue"])])),_:1})}var c={data(){return{term:"",isSearchMode:!1,currentPage:1,sortByColumn:"product.Name",sortDesc:!1,headers:[{value:"index",title:"№",width:"10%"},{value:"name",title:"Изделие",width:"20%"},{value:"inProgressCount",title:"в работе (шт)",width:"15%"},{value:"completedCount",title:"собрано (шт)",width:"15%"},{value:"totalCount",title:"всего (шт)",width:"15%"},{value:"status",title:"Статус",width:"10%"},{value:"actions",title:"",width:"15%"}]}},created(){this.isAuthorized&&this.loadData()},computed:{productionOrders(){return this.$store.getters.productionOrders},itemsPerPage(){return this.$store.getters.pageSize},pagesCount(){return Math.ceil(this.$store.getters.pageItemsCount/this.itemsPerPage)},isLoading(){return this.$store.getters.isLoading},isAuthorized(){return this.$store.getters.isAuthorized}},methods:{loadData(){this.$store.commit("setSearchParameters",this.term),this.$store.dispatch("loadProductionOrders").catch((t=>{401===t.status?(this.$store.commit("setAlertMessage","Вы не авторизованы"),this.$store.commit("isShowErrorAlert",!0),this.$store.dispatch("clearAuthData")):403===t.status?(this.$store.commit("setAlertMessage","У вас нет прав для получения данной информации"),this.$store.commit("isShowErrorAlert",!0)):(this.$store.commit("setAlertMessage","Не удалось загрузить список производственных заказов"),this.$store.commit("isShowErrorAlert",!0))}))},showTaskCreateModal(){this.$store.dispatch("loadEmployees").catch((()=>{this.$store.commit("setAlertMessage","Не удалось загрузить список сотрудников."),this.$store.commit("isShowErrorAlert",!0)})),this.$store.commit("isShowTaskCreateModal",!0)},endProductionOrder(t){this.$store.dispatch("deleteProductionOrder",t.id).catch((()=>{this.$store.commit("setAlertMessage","Не удалось завершить производственную задачу. Возможно остались не завершенные задачи"),this.$store.commit("isShowErrorAlert",!0)}))},search(){0!==this.term.length&&(this.$store.commit("setSearchParameters",this.term),this.isSearchMode=!0,this.$store.dispatch("loadProductionOrders").catch((()=>{this.$store.commit("setAlertMessage","Не удалось загрузить список производственных заказов"),this.$store.commit("isShowErrorAlert",!0)})))},cancelSearch(){this.isSearchMode&&(this.term="",this.$store.commit("setSearchParameters",this.term),this.isSearchMode=!1,this.$store.dispatch("loadProductionOrders").catch((()=>{this.$store.commit("setAlertMessage","Не удалось загрузить список производственных заказов"),this.$store.commit("isShowErrorAlert",!0)})))},sortBy(t){this.sortByColumn===t?this.sortDesc=!this.sortDesc:(this.sortDesc=!1,this.sortByColumn=t),this.$store.commit("setSortingParameters",{sortBy:this.sortByColumn,isDesc:this.sortDesc}),this.$store.dispatch("loadProductionOrders").catch((()=>{this.$store.commit("setAlertMessage","Не удалось загрузить список производственных заказов"),this.$store.commit("isShowErrorAlert",!0)}))},switchPage(t){this.$store.commit("setPageNumber",t),this.$store.dispatch("loadProductionOrders").catch((()=>{this.$store.commit("setAlertMessage","Не удалось загрузить список производственных заказов"),this.$store.commit("isShowErrorAlert",!0)}))},getColor(t){return"Pending"===t?"error":"InProgress"===t?"secondary":"success"},showLoginModal(){this.$store.commit("setIsShowLoginModal",!0)}}},n=s(1241);const d=(0,n.A)(c,[["render",l]]);var u=d}}]);
//# sourceMappingURL=808.6768b892.js.map