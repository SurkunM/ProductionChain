"use strict";(self["webpackChunkfrontend"]=self["webpackChunkfrontend"]||[]).push([[938],{4938:function(e,t,r){r.r(t),r.d(t,{default:function(){return c}});var s=r(6768),o=r(5130),i=r(4232);function a(e,t,r,a,l,u){const n=(0,s.g2)("v-progress-linear"),c=(0,s.g2)("v-snackbar"),d=(0,s.g2)("v-icon"),m=(0,s.g2)("v-btn"),h=(0,s.g2)("v-text-field"),k=(0,s.g2)("v-data-table"),p=(0,s.g2)("v-pagination"),v=(0,s.g2)("v-card");return(0,s.uX)(),(0,s.Wv)(v,{title:"История",flat:""},{text:(0,s.k6)((()=>[(0,s.bF)(h,{modelValue:l.term,"onUpdate:modelValue":t[2]||(t[2]=e=>l.term=e),label:"Найти",autocomplete:"off","prepend-inner-icon":"mdi-magnify",variant:"outlined","hide-details":"","single-line":"",onKeyup:(0,o.jR)(u.search,["enter"])},{"append-inner":(0,s.k6)((()=>[(0,s.bF)(m,{icon:"",onClick:u.search,color:"primary",size:"small"},{default:(0,s.k6)((()=>[(0,s.bF)(d,null,{default:(0,s.k6)((()=>t[10]||(t[10]=[(0,s.eW)("mdi-magnify")]))),_:1,__:[10]})])),_:1},8,["onClick"]),(0,s.bF)(d,{onClick:u.cancelSearch,style:{cursor:"pointer"},size:"x-large",class:"ms-1 me-2"},{default:(0,s.k6)((()=>t[11]||(t[11]=[(0,s.eW)(" mdi-close-circle ")]))),_:1,__:[11]},8,["onClick"])])),_:1},8,["modelValue","onKeyup"])])),default:(0,s.k6)((()=>[u.isLoading?((0,s.uX)(),(0,s.Wv)(n,{key:0,indeterminate:"",color:"primary",height:"4"})):(0,s.Q3)("",!0),(0,s.bF)(c,{modelValue:l.isShowSuccessAlert,"onUpdate:modelValue":t[0]||(t[0]=e=>l.isShowSuccessAlert=e),timeout:2e3,color:"success"},{default:(0,s.k6)((()=>[(0,s.eW)((0,i.v_)(l.alertText),1)])),_:1},8,["modelValue"]),(0,s.bF)(c,{modelValue:l.isShowErrorAlert,"onUpdate:modelValue":t[1]||(t[1]=e=>l.isShowErrorAlert=e),timeout:2e3,color:"error"},{default:(0,s.k6)((()=>[(0,s.eW)((0,i.v_)(l.alertText),1)])),_:1},8,["modelValue"]),(0,s.bF)(k,{headers:l.headers,items:u.histories,"hide-default-footer":"","items-per-page":u.itemsPerPage,"no-data-text":"Список пуст"},{["header.employee"]:(0,s.k6)((({column:e})=>[(0,s.Lk)("button",{onClick:t[3]||(t[3]=e=>u.sortBy("employee"))},(0,i.v_)(e.title),1),l.sortByColumn===e.value?((0,s.uX)(),(0,s.Wv)(d,{key:0},{default:(0,s.k6)((()=>[(0,s.eW)((0,i.v_)(l.sortDesc?"mdi-menu-up":"mdi-menu-down"),1)])),_:1})):(0,s.Q3)("",!0)])),["header.taskId"]:(0,s.k6)((({column:e})=>[(0,s.Lk)("button",{onClick:t[4]||(t[4]=e=>u.sortBy("ProductionTaskId"))},(0,i.v_)(e.title),1),l.sortByColumn===e.value?((0,s.uX)(),(0,s.Wv)(d,{key:0},{default:(0,s.k6)((()=>[(0,s.eW)((0,i.v_)(l.sortDesc?"mdi-menu-up":"mdi-menu-down"),1)])),_:1})):(0,s.Q3)("",!0)])),["header.product"]:(0,s.k6)((({column:e})=>[(0,s.Lk)("button",{onClick:t[5]||(t[5]=e=>u.sortBy("product"))},(0,i.v_)(e.title),1),l.sortByColumn===e.value?((0,s.uX)(),(0,s.Wv)(d,{key:0},{default:(0,s.k6)((()=>[(0,s.eW)((0,i.v_)(l.sortDesc?"mdi-menu-up":"mdi-menu-down"),1)])),_:1})):(0,s.Q3)("",!0)])),["header.productsCount"]:(0,s.k6)((({column:e})=>[(0,s.Lk)("button",{onClick:t[6]||(t[6]=e=>u.sortBy("productsCount"))},(0,i.v_)(e.title),1),l.sortByColumn===e.value?((0,s.uX)(),(0,s.Wv)(d,{key:0},{default:(0,s.k6)((()=>[(0,s.eW)((0,i.v_)(l.sortDesc?"mdi-menu-up":"mdi-menu-down"),1)])),_:1})):(0,s.Q3)("",!0)])),["header.startTime"]:(0,s.k6)((({column:e})=>[(0,s.Lk)("button",{onClick:t[7]||(t[7]=e=>u.sortBy("startTime"))},(0,i.v_)(e.title),1),l.sortByColumn===e.value?((0,s.uX)(),(0,s.Wv)(d,{key:0},{default:(0,s.k6)((()=>[(0,s.eW)((0,i.v_)(l.sortDesc?"mdi-menu-up":"mdi-menu-down"),1)])),_:1})):(0,s.Q3)("",!0)])),["header.endTime"]:(0,s.k6)((({column:e})=>[(0,s.Lk)("button",{onClick:t[8]||(t[8]=e=>u.sortBy("endTime"))},(0,i.v_)(e.title),1),l.sortByColumn===e.value?((0,s.uX)(),(0,s.Wv)(d,{key:0},{default:(0,s.k6)((()=>[(0,s.eW)((0,i.v_)(l.sortDesc?"mdi-menu-up":"mdi-menu-down"),1)])),_:1})):(0,s.Q3)("",!0)])),_:2},1032,["headers","items","items-per-page"]),(0,s.bF)(p,{modelValue:l.currentPage,"onUpdate:modelValue":[t[9]||(t[9]=e=>l.currentPage=e),u.switchPage],length:u.pagesCount,circle:"",color:"primary"},null,8,["modelValue","length","onUpdate:modelValue"])])),_:1})}var l={data(){return{term:"",isSearchMode:!1,currentPage:1,sortByColumn:"",sortDesc:!1,headers:[{value:"index",title:"№"},{value:"employee",title:"Сотрудник"},{value:"taskId",title:"Id задачи"},{value:"product",title:"Продукция"},{value:"productsCount",title:"шт"},{value:"startTime",title:"Дата начала"},{value:"endTime",title:"Дата завершения"}],isShowSuccessAlert:!1,isShowErrorAlert:!1,alertText:""}},created(){this.$store.commit("setSearchParameters",this.term),this.$store.dispatch("loadHistories").catch((()=>{this.showErrorAlert("Ошибка! Не удалось загрузить список историй задач.")}))},computed:{histories(){return this.$store.getters.histories},itemsPerPage(){return this.$store.getters.pageSize},pagesCount(){return Math.ceil(this.$store.getters.pageItemsCount/this.itemsPerPage)},isLoading(){return this.$store.getters.isLoading}},methods:{search(){0!==this.term.length&&(this.$store.commit("setSearchParameters",this.term),this.isSearchMode=!0,this.$store.dispatch("loadHistories").catch((()=>{this.showErrorAlert("Ошибка! Не удалось загрузить список историй задач.")})))},cancelSearch(){this.isSearchMode&&(this.term="",this.$store.commit("setSearchParameters",this.term),this.isSearchMode=!1,this.$store.dispatch("loadHistories").catch((()=>{this.showErrorAlert("Ошибка! Не удалось загрузить список историй задач.")})))},sortBy(e){this.sortByColumn===e?this.sortDesc=!this.sortDesc:(this.sortDesc=!1,this.sortByColumn=e),this.$store.commit("setSortingParameters",{sortBy:this.sortByColumn,isDesc:this.sortDesc}),this.$store.dispatch("loadHistories").catch((()=>{this.showErrorAlert("Ошибка! Не удалось загрузить список историй задач.")}))},switchPage(e){this.$store.commit("setPageNumber",e),this.$store.dispatch("loadHistories").catch((()=>{this.showErrorAlert("Ошибка! Не удалось загрузить список историй задач.")}))},showSuccessAlert(e){this.alertText=e,this.isShowSuccessAlert=!0},showErrorAlert(e){this.alertText=e,this.isShowErrorAlert=!0}}},u=r(1241);const n=(0,u.A)(l,[["render",a]]);var c=n}}]);
//# sourceMappingURL=938.970ac3de.js.map