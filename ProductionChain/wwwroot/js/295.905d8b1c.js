"use strict";(self["webpackChunkfrontend"]=self["webpackChunkfrontend"]||[]).push([[295],{7295:function(e,t,r){r.r(t),r.d(t,{default:function(){return d}});var o=r(6768),s=r(5130),i=r(4232);const a=["onClick"];function l(e,t,r,l,u,n){const c=(0,o.g2)("v-progress-linear"),d=(0,o.g2)("v-snackbar"),h=(0,o.g2)("v-icon"),m=(0,o.g2)("v-btn"),v=(0,o.g2)("v-text-field"),g=(0,o.g2)("v-chip"),k=(0,o.g2)("v-data-table"),p=(0,o.g2)("v-pagination"),C=(0,o.g2)("v-card");return(0,o.uX)(),(0,o.Wv)(C,{title:"Заказы",flat:""},{text:(0,o.k6)((()=>[(0,o.bF)(v,{modelValue:u.term,"onUpdate:modelValue":t[2]||(t[2]=e=>u.term=e),label:"Найти",autocomplete:"off","prepend-inner-icon":"mdi-magnify",variant:"outlined","hide-details":"","single-line":"",onKeyup:(0,s.jR)(n.search,["enter"])},{"append-inner":(0,o.k6)((()=>[(0,o.bF)(m,{icon:"",onClick:n.search,color:"primary",size:"small"},{default:(0,o.k6)((()=>[(0,o.bF)(h,null,{default:(0,o.k6)((()=>t[8]||(t[8]=[(0,o.eW)("mdi-magnify")]))),_:1,__:[8]})])),_:1},8,["onClick"]),(0,o.bF)(h,{onClick:n.cancelSearch,style:{cursor:"pointer"},size:"x-large",class:"ms-1 me-2"},{default:(0,o.k6)((()=>t[9]||(t[9]=[(0,o.eW)(" mdi-close-circle ")]))),_:1,__:[9]},8,["onClick"])])),_:1},8,["modelValue","onKeyup"])])),default:(0,o.k6)((()=>[n.isLoading?((0,o.uX)(),(0,o.Wv)(c,{key:0,indeterminate:"",color:"primary",height:"4"})):(0,o.Q3)("",!0),(0,o.bF)(d,{modelValue:u.isShowSuccessAlert,"onUpdate:modelValue":t[0]||(t[0]=e=>u.isShowSuccessAlert=e),timeout:2e3,color:"success"},{default:(0,o.k6)((()=>[(0,o.eW)((0,i.v_)(u.alertText),1)])),_:1},8,["modelValue"]),(0,o.bF)(d,{modelValue:u.isShowErrorAlert,"onUpdate:modelValue":t[1]||(t[1]=e=>u.isShowErrorAlert=e),timeout:2e3,color:"error"},{default:(0,o.k6)((()=>[(0,o.eW)((0,i.v_)(u.alertText),1)])),_:1},8,["modelValue"]),(0,o.bF)(k,{headers:u.headers,items:n.orders,"hide-default-footer":"","items-per-page":n.itemsPerPage,"no-data-text":"Список пуст"},{["header.customer"]:(0,o.k6)((({column:e})=>[(0,o.Lk)("button",{onClick:t[3]||(t[3]=e=>n.sortBy("customer"))},(0,i.v_)(e.title),1),u.sortByColumn===e.value?((0,o.uX)(),(0,o.Wv)(h,{key:0},{default:(0,o.k6)((()=>[(0,o.eW)((0,i.v_)(u.sortDesc?"mdi-menu-up":"mdi-menu-down"),1)])),_:1})):(0,o.Q3)("",!0)])),["header.productName"]:(0,o.k6)((({column:e})=>[(0,o.Lk)("button",{onClick:t[4]||(t[4]=e=>n.sortBy("product.Name"))},(0,i.v_)(e.title),1),u.sortByColumn===e.value?((0,o.uX)(),(0,o.Wv)(h,{key:0},{default:(0,o.k6)((()=>[(0,o.eW)((0,i.v_)(u.sortDesc?"mdi-menu-up":"mdi-menu-down"),1)])),_:1})):(0,o.Q3)("",!0)])),["header.orderedProductsCount"]:(0,o.k6)((({column:e})=>[(0,o.Lk)("button",{onClick:t[5]||(t[5]=e=>n.sortBy("orderedProductsCount"))},(0,i.v_)(e.title),1),u.sortByColumn===e.value?((0,o.uX)(),(0,o.Wv)(h,{key:0},{default:(0,o.k6)((()=>[(0,o.eW)((0,i.v_)(u.sortDesc?"mdi-menu-up":"mdi-menu-down"),1)])),_:1})):(0,o.Q3)("",!0)])),["header.availableProductsCount"]:(0,o.k6)((({column:e})=>[(0,o.Lk)("button",{onClick:t[6]||(t[6]=e=>n.sortBy("availableProductsCount"))},(0,i.v_)(e.title),1),u.sortByColumn===e.value?((0,o.uX)(),(0,o.Wv)(h,{key:0},{default:(0,o.k6)((()=>[(0,o.eW)((0,i.v_)(u.sortDesc?"mdi-menu-up":"mdi-menu-down"),1)])),_:1})):(0,o.Q3)("",!0)])),["header.status"]:(0,o.k6)((({column:e})=>[(0,o.Lk)("button",{onClick:t=>n.sortBy(e.status)},(0,i.v_)(e.title),9,a),u.sortByColumn===e.value?((0,o.uX)(),(0,o.Wv)(h,{key:0},{default:(0,o.k6)((()=>[(0,o.eW)((0,i.v_)(u.sortDesc?"mdi-menu-up":"mdi-menu-down"),1)])),_:1})):(0,o.Q3)("",!0)])),["item.status"]:(0,o.k6)((({value:e,item:t})=>[(0,o.bF)(g,{border:`${n.getColor(e)} thin opacity-25`,color:n.getColor(e),text:t.statusMap,size:"small"},null,8,["border","color","text"])])),["item.actions"]:(0,o.k6)((({item:e})=>[(0,o.Lk)("div",null,[n.isStatusPending(e.status)?((0,o.uX)(),(0,o.Wv)(m,{key:0,size:"small",color:"info",onClick:t=>n.createProductionOrder(e)},{default:(0,o.k6)((()=>t[10]||(t[10]=[(0,o.eW)("Начать")]))),_:2,__:[10]},1032,["onClick"])):(0,o.Q3)("",!0)])])),_:2},1032,["headers","items","items-per-page"]),(0,o.bF)(p,{modelValue:u.currentPage,"onUpdate:modelValue":[t[7]||(t[7]=e=>u.currentPage=e),n.switchPage],length:n.pagesCount,circle:"",color:"primary"},null,8,["modelValue","length","onUpdate:modelValue"])])),_:1})}var u={data(){return{term:"",isSearchMode:!1,currentPage:1,sortByColumn:"customer",sortDesc:!1,headers:[{value:"index",title:"№"},{value:"customer",title:"Заказчик",width:"20%"},{value:"productName",title:"Изделие",width:"20%"},{value:"orderedProductsCount",title:"Заказано (шт)"},{value:"availableProductsCount",title:"В налиии (шт)"},{value:"status",title:"Статус"},{value:"actions",title:""}],isShowSuccessAlert:!1,isShowErrorAlert:!1,alertText:""}},created(){this.$store.commit("setSearchParameters",this.term),this.$store.dispatch("loadOrders").catch((()=>{this.showErrorAlert("Ошибка! Не удалось загрузить список заказов.")}))},computed:{orders(){return this.$store.getters.orders},itemsPerPage(){return this.$store.getters.pageSize},pagesCount(){return Math.ceil(this.$store.getters.pageItemsCount/this.itemsPerPage)},isLoading(){return this.$store.getters.isLoading}},methods:{createProductionOrder(e){const t={orderId:e.id,productId:e.productId,productsCount:e.productsCount,availableCount:e.availableCount};this.$store.dispatch("createProductionOrder",t).then((()=>{this.showSuccessAlert("Производственная задача успешно создана.")})).catch((()=>{this.showErrorAlert("Ошибка! Не удалось создать производственную задачу.")}))},search(){0!==this.term.length&&(this.$store.commit("setSearchParameters",this.term),this.isSearchMode=!0,this.$store.dispatch("loadOrders").catch((()=>{this.showErrorAlert("Ошибка! Не удалось загрузить список заказов.")})))},cancelSearch(){this.isSearchMode&&(this.term="",this.$store.commit("setSearchParameters",this.term),this.isSearchMode=!1,this.$store.dispatch("loadOrders").catch((()=>{this.showErrorAlert("Ошибка! Не удалось загрузить список заказов.")})))},sortBy(e){this.sortByColumn===e?this.sortDesc=!this.sortDesc:(this.sortDesc=!1,this.sortByColumn=e),this.$store.commit("setSortingParameters",{sortBy:this.sortByColumn,isDesc:this.sortDesc}),this.$store.dispatch("loadOrders").catch((()=>{this.showErrorAlert("Ошибка! Не удалось загрузить список заказов.")}))},switchPage(e){this.$store.commit("setPageNumber",e),this.$store.dispatch("loadOrders").catch((()=>{this.showErrorAlert("Ошибка! Не удалось загрузить список заказов.")}))},getColor(e){return"Pending"===e?"error":"InProgress"===e?"warning":"Done"===e?"success":void 0},isStatusPending(e){return"Pending"===e},showSuccessAlert(e){this.alertText=e,this.isShowSuccessAlert=!0},showErrorAlert(e){this.alertText=e,this.isShowErrorAlert=!0}}},n=r(1241);const c=(0,n.A)(u,[["render",l]]);var d=c}}]);
//# sourceMappingURL=295.905d8b1c.js.map