"use strict";(self["webpackChunkfrontend"]=self["webpackChunkfrontend"]||[]).push([[666],{1666:function(e,t,s){s.r(t),s.d(t,{default:function(){return m}});var o=s(6768),r=s(5130),i=s(4232);function a(e,t,s,a,l,c){const n=(0,o.g2)("v-progress-linear"),m=(0,o.g2)("v-icon"),u=(0,o.g2)("v-btn"),d=(0,o.g2)("v-text-field"),h=(0,o.g2)("v-data-table"),g=(0,o.g2)("v-card-title"),k=(0,o.g2)("v-card-text"),p=(0,o.g2)("v-card"),v=(0,o.g2)("v-col"),_=(0,o.g2)("v-row"),y=(0,o.g2)("v-container"),f=(0,o.g2)("v-pagination");return(0,o.uX)(),(0,o.Wv)(p,{title:"Задачи",flat:""},{text:(0,o.k6)((()=>[(0,o.bF)(d,{modelValue:l.term,"onUpdate:modelValue":t[0]||(t[0]=e=>l.term=e),label:"Найти",autocomplete:"off","prepend-inner-icon":"mdi-magnify",variant:"outlined","hide-details":"","single-line":"",onKeyup:(0,r.jR)(c.search,["enter"])},{"append-inner":(0,o.k6)((()=>[(0,o.bF)(u,{icon:"",onClick:c.search,color:"primary",size:"small"},{default:(0,o.k6)((()=>[(0,o.bF)(m,null,{default:(0,o.k6)((()=>t[7]||(t[7]=[(0,o.eW)("mdi-magnify")]))),_:1,__:[7]})])),_:1},8,["onClick"]),(0,o.bF)(m,{onClick:c.cancelSearch,style:{cursor:"pointer"},size:"x-large",class:"ms-1 me-2"},{default:(0,o.k6)((()=>t[8]||(t[8]=[(0,o.eW)(" mdi-close-circle ")]))),_:1,__:[8]},8,["onClick"])])),_:1},8,["modelValue","onKeyup"])])),default:(0,o.k6)((()=>[c.isLoading?((0,o.uX)(),(0,o.Wv)(n,{key:0,indeterminate:"",color:"primary",height:"4"})):(0,o.Q3)("",!0),c.isAuthorized?((0,o.uX)(),(0,o.Wv)(h,{key:1,headers:l.headers,items:c.tasks,"hide-default-footer":"","items-per-page":c.itemsPerPage,"no-data-text":"Список пуст"},{["header.product"]:(0,o.k6)((({column:e})=>[(0,o.Lk)("button",{onClick:t[1]||(t[1]=e=>c.sortBy("product.Name"))},(0,i.v_)(e.title),1),l.sortByColumn===e.value?((0,o.uX)(),(0,o.Wv)(m,{key:0},{default:(0,o.k6)((()=>[(0,o.eW)((0,i.v_)(l.sortDesc?"mdi-menu-up":"mdi-menu-down"),1)])),_:1})):(0,o.Q3)("",!0)])),["header.employee"]:(0,o.k6)((({column:e})=>[(0,o.Lk)("button",{onClick:t[2]||(t[2]=e=>c.sortBy("employee.LastName"))},(0,i.v_)(e.title),1),l.sortByColumn===e.value?((0,o.uX)(),(0,o.Wv)(m,{key:0},{default:(0,o.k6)((()=>[(0,o.eW)((0,i.v_)(l.sortDesc?"mdi-menu-up":"mdi-menu-down"),1)])),_:1})):(0,o.Q3)("",!0)])),["header.productsCount"]:(0,o.k6)((({column:e})=>[(0,o.Lk)("button",{onClick:t[3]||(t[3]=e=>c.sortBy("productsCount"))},(0,i.v_)(e.title),1),l.sortByColumn===e.value?((0,o.uX)(),(0,o.Wv)(m,{key:0},{default:(0,o.k6)((()=>[(0,o.eW)((0,i.v_)(l.sortDesc?"mdi-menu-up":"mdi-menu-down"),1)])),_:1})):(0,o.Q3)("",!0)])),["header.startTime"]:(0,o.k6)((({column:e})=>[(0,o.Lk)("button",{onClick:t[4]||(t[4]=e=>c.sortBy("startTime"))},(0,i.v_)(e.title),1),l.sortByColumn===e.value?((0,o.uX)(),(0,o.Wv)(m,{key:0},{default:(0,o.k6)((()=>[(0,o.eW)((0,i.v_)(l.sortDesc?"mdi-menu-up":"mdi-menu-down"),1)])),_:1})):(0,o.Q3)("",!0)])),["item.actions"]:(0,o.k6)((({item:e})=>[(0,o.Lk)("div",null,[e.inProgress?(0,o.Q3)("",!0):((0,o.uX)(),(0,o.Wv)(u,{key:0,size:"small",color:"info",onClick:t=>c.completeTask(e),class:"me-2"},{default:(0,o.k6)((()=>t[9]||(t[9]=[(0,o.eW)("Заверишть задачу")]))),_:2,__:[9]},1032,["onClick"]))])])),_:2},1032,["headers","items","items-per-page"])):((0,o.uX)(),(0,o.Wv)(y,{key:2,class:"fill-height",fluid:""},{default:(0,o.k6)((()=>[(0,o.bF)(_,{align:"center",justify:"center"},{default:(0,o.k6)((()=>[(0,o.bF)(v,{cols:"12",sm:"8",md:"6",lg:"4"},{default:(0,o.k6)((()=>[(0,o.bF)(p,{class:"text-center pa-8"},{default:(0,o.k6)((()=>[(0,o.bF)(m,{size:"64",color:"grey-lighten-1",class:"mb-4"},{default:(0,o.k6)((()=>t[10]||(t[10]=[(0,o.eW)(" mdi-account-lock ")]))),_:1,__:[10]}),(0,o.bF)(g,{class:"text-h5 justify-center"},{default:(0,o.k6)((()=>t[11]||(t[11]=[(0,o.eW)(" Требуется авторизация ")]))),_:1,__:[11]}),(0,o.bF)(k,null,{default:(0,o.k6)((()=>[t[13]||(t[13]=(0,o.Lk)("p",{class:"text-body-1 mb-4"}," Для просмотра этой страницы необходимо войти в систему ",-1)),(0,o.bF)(u,{color:"primary",onClick:t[5]||(t[5]=e=>c.showLoginModal())},{default:(0,o.k6)((()=>t[12]||(t[12]=[(0,o.eW)(" Войти ")]))),_:1,__:[12]})])),_:1,__:[13]})])),_:1})])),_:1})])),_:1})])),_:1})),(0,o.bF)(f,{modelValue:l.currentPage,"onUpdate:modelValue":[t[6]||(t[6]=e=>l.currentPage=e),c.switchPage],length:c.pagesCount,circle:"",color:"primary"},null,8,["modelValue","length","onUpdate:modelValue"])])),_:1})}var l={data(){return{term:"",isSearchMode:!1,currentPage:1,sortByColumn:"product.Name",sortDesc:!1,headers:[{value:"index",title:"№",align:"center"},{value:"product",title:"Изделие"},{value:"employee",title:"Сотрудник"},{value:"productsCount",title:"шт"},{value:"startTime",title:"Начало"},{value:"actions",title:""}]}},created(){this.isAuthorized&&this.loadData()},computed:{tasks(){return this.$store.getters.tasks},itemsPerPage(){return this.$store.getters.pageSize},pagesCount(){return Math.ceil(this.$store.getters.pageItemsCount/this.itemsPerPage)},isLoading(){return this.$store.getters.isLoading},isAuthorized(){return this.$store.getters.isAuthorized}},methods:{loadData(){this.$store.commit("setSearchParameters",this.term),this.$store.dispatch("loadProductionTasks").catch((e=>{401===e.status?(this.$store.commit("setAlertMessage","Ошибка! Вы не авторизованы."),this.$store.commit("isShowErrorAlert",!0)):403===e.status?(this.$store.commit("setAlertMessage","У вас нет прав для получения данной информации."),this.$store.commit("isShowErrorAlert",!0)):(this.$store.commit("setAlertMessage","Ошибка! Не удалось загрузить список задачи."),this.$store.commit("isShowErrorAlert",!0))}))},completeTask(e){const t={id:e.id,productionOrderId:e.productionOrderId,employeeId:e.employeeId,productId:e.productId,productsCount:e.productsCount};this.$store.dispatch("deleteProductionTask",t).then((()=>{this.$store.commit("setAlertMessage","Задача успешно завершена."),this.$store.commit("isShowSuccessAlert",!0)})).catch((()=>{this.$store.commit("setAlertMessage","Ошибка! Не удалось завершить задачу."),this.$store.commit("isShowErrorAlert",!0)}))},search(){0!==this.term.length&&(this.$store.commit("setSearchParameters",this.term),this.isSearchMode=!0,this.$store.dispatch("loadProductionTasks").catch((()=>{this.$store.commit("setAlertMessage","Ошибка! Не удалось загрузить список задачи."),this.$store.commit("isShowErrorAlert",!0)})))},cancelSearch(){this.isSearchMode&&(this.term="",this.$store.commit("setSearchParameters",this.term),this.isSearchMode=!1,this.$store.dispatch("loadProductionTasks").catch((()=>{this.$store.commit("setAlertMessage","Ошибка! Не удалось загрузить список задачи."),this.$store.commit("isShowErrorAlert",!0)})))},sortBy(e){this.sortByColumn===e?this.sortDesc=!this.sortDesc:(this.sortDesc=!1,this.sortByColumn=e),this.$store.commit("setSortingParameters",{sortBy:this.sortByColumn,isDesc:this.sortDesc}),this.$store.dispatch("loadProductionTasks").catch((()=>{this.$store.commit("setAlertMessage","Ошибка! Не удалось загрузить список задачи."),this.$store.commit("isShowErrorAlert",!0)}))},switchPage(e){this.$store.commit("setPageNumber",e),this.$store.dispatch("loadProductionTasks").catch((()=>{this.$store.commit("setAlertMessage","Ошибка! Не удалось загрузить список задачи."),this.$store.commit("isShowErrorAlert",!0)}))},showLoginModal(){this.$store.commit("setIsShowLoginModal",!0)}}},c=s(1241);const n=(0,c.A)(l,[["render",a]]);var m=n}}]);
//# sourceMappingURL=666.cdf50341.js.map