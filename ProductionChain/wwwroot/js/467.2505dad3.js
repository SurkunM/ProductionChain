"use strict";(self["webpackChunkfrontend"]=self["webpackChunkfrontend"]||[]).push([[467],{467:function(e,t,o){o.r(t),o.d(t,{default:function(){return n}});var s=o(6768),r=o(4232);function l(e,t,o,l,a,i){const d=(0,s.g2)("v-progress-linear"),u=(0,s.g2)("v-btn"),n=(0,s.g2)("v-data-table"),c=(0,s.g2)("v-icon"),m=(0,s.g2)("v-card-title"),h=(0,s.g2)("v-card-text"),p=(0,s.g2)("v-card"),k=(0,s.g2)("v-col"),f=(0,s.g2)("v-row"),g=(0,s.g2)("v-container"),v=(0,s.g2)("production-task-create-modal");return(0,s.uX)(),(0,s.CE)(s.FK,null,[(0,s.bF)(p,{title:"Очередь на получение задач",flat:""},{default:(0,s.k6)((()=>[i.isLoading?((0,s.uX)(),(0,s.Wv)(d,{key:0,indeterminate:"",color:"primary",height:"4"})):(0,s.Q3)("",!0),i.isAuthorized?((0,s.uX)(),(0,s.Wv)(n,{key:1,headers:a.headers,items:i.taskQueue,"hide-default-footer":"","no-data-text":"Список пуст"},{["header.fullName"]:(0,s.k6)((({column:e})=>[(0,s.eW)((0,r.v_)(e.title),1)])),["header.date"]:(0,s.k6)((({column:e})=>[(0,s.eW)((0,r.v_)(e.title),1)])),["item.actions"]:(0,s.k6)((({item:e})=>[(0,s.Lk)("div",null,[(0,s.Lk)("template",null,[(0,s.bF)(u,{size:"small",color:"info",onClick:t=>i.showTaskCreateModal(e),class:"mt-2"},{default:(0,s.k6)((()=>t[1]||(t[1]=[(0,s.eW)("Создать задачу")]))),_:2,__:[1]},1032,["onClick"])]),(0,s.Lk)("template",null,[(0,s.bF)(u,{size:"small",color:"info",onClick:t=>i.completeTask(e),class:"me-2"},{default:(0,s.k6)((()=>t[2]||(t[2]=[(0,s.eW)("Заверишть задачу")]))),_:2,__:[2]},1032,["onClick"])])])])),_:2},1032,["headers","items"])):((0,s.uX)(),(0,s.Wv)(g,{key:2,class:"fill-height",fluid:""},{default:(0,s.k6)((()=>[(0,s.bF)(f,{align:"center",justify:"center"},{default:(0,s.k6)((()=>[(0,s.bF)(k,{cols:"12",sm:"8",md:"6",lg:"4"},{default:(0,s.k6)((()=>[(0,s.bF)(p,{class:"text-center pa-8"},{default:(0,s.k6)((()=>[(0,s.bF)(c,{size:"64",color:"grey-lighten-1",class:"mb-4"},{default:(0,s.k6)((()=>t[3]||(t[3]=[(0,s.eW)(" mdi-account-lock ")]))),_:1,__:[3]}),(0,s.bF)(m,{class:"text-h5 justify-center"},{default:(0,s.k6)((()=>t[4]||(t[4]=[(0,s.eW)(" Требуется авторизация ")]))),_:1,__:[4]}),(0,s.bF)(h,null,{default:(0,s.k6)((()=>[t[6]||(t[6]=(0,s.Lk)("p",{class:"text-body-1 mb-4"}," Для просмотра этой страницы необходимо войти в систему ",-1)),(0,s.bF)(u,{color:"primary",onClick:t[0]||(t[0]=e=>i.showLoginModal())},{default:(0,s.k6)((()=>t[5]||(t[5]=[(0,s.eW)(" Войти ")]))),_:1,__:[5]})])),_:1,__:[6]})])),_:1})])),_:1})])),_:1})])),_:1}))])),_:1}),(0,s.Lk)("template",null,[(0,s.bF)(v,{ref:"productionTaskCreateModal",onSave:e.createTask},null,8,["onSave"])])],64)}var a=o(3e3),i={components:{ProductionTaskCreateModal:a.A},data(){return{headers:[{value:"index",title:"№",align:"center"},{value:"fullName",title:"Сотрудник"},{value:"date",title:"Дата"},{value:"actions",title:""}]}},created(){this.isAuthorized},computed:{taskQueue(){return this.$store.getters.taskQueue},isLoading(){return this.$store.getters.isLoading},isAuthorized(){return this.$store.getters.isAuthorized}},methods:{completeTask(e){const t={id:e.id,productionOrderId:e.productionOrderId,employeeId:e.employeeId,productId:e.productId,productsCount:e.productsCount};this.$store.dispatch("deleteProductionTask",t).then((()=>{this.$store.commit("setAlertMessage","Задача успешно завершена."),this.$store.commit("isShowSuccessAlert",!0)})).catch((()=>{this.$store.commit("setAlertMessage","Ошибка! Не удалось завершить задачу."),this.$store.commit("isShowErrorAlert",!0)}))},showTaskCreateModal(e){this.$refs.productionTaskCreateModal.show(e)},showLoginModal(){this.$store.commit("setIsShowLoginModal",!0)}}},d=o(1241);const u=(0,d.A)(i,[["render",l]]);var n=u},3e3:function(e,t,o){o.d(t,{A:function(){return m}});var s=o(6768),r=o(5130),l=o(4232);const a={class:"mb-2"},i={class:"text-h5"};function d(e,t,o,d,u,n){const c=(0,s.g2)("v-toolbar-title"),m=(0,s.g2)("v-icon"),h=(0,s.g2)("v-btn"),p=(0,s.g2)("v-toolbar"),k=(0,s.g2)("v-text-field"),f=(0,s.g2)("v-select"),g=(0,s.g2)("v-card-text"),v=(0,s.g2)("v-spacer"),_=(0,s.g2)("v-card-actions"),b=(0,s.g2)("v-form"),F=(0,s.g2)("v-card"),C=(0,s.g2)("v-dialog");return(0,s.uX)(),(0,s.Wv)(C,{modelValue:u.isShow,"onUpdate:modelValue":t[1]||(t[1]=e=>u.isShow=e),persistent:"","max-width":"600px"},{default:(0,s.k6)((()=>[(0,s.bF)(F,null,{default:(0,s.k6)((()=>[(0,s.bF)(p,{dark:"",color:"primary"},{default:(0,s.k6)((()=>[(0,s.bF)(c,null,{default:(0,s.k6)((()=>t[2]||(t[2]=[(0,s.eW)("Создание задачи")]))),_:1,__:[2]}),(0,s.bF)(h,{icon:"",dark:"",onClick:n.hide},{default:(0,s.k6)((()=>[(0,s.bF)(m,null,{default:(0,s.k6)((()=>t[3]||(t[3]=[(0,s.eW)("mdi-close")]))),_:1,__:[3]})])),_:1},8,["onClick"])])),_:1}),(0,s.bF)(b,{onSubmit:(0,r.D$)(n.submitForm,["prevent"])},{default:(0,s.k6)((()=>[(0,s.bF)(g,null,{default:(0,s.k6)((()=>[(0,s.Lk)("div",a,[t[4]||(t[4]=(0,s.Lk)("span",{class:"text-h6 font-weight-bold ms-1"},"Изделие: ",-1)),(0,s.Lk)("span",i,(0,l.v_)(u.task.productName),1)]),(0,s.bF)(k,{modelValue:u.task.productsCount,"onUpdate:modelValue":t[0]||(t[0]=e=>u.task.productsCount=e),modelModifiers:{trim:!0},label:"Количество","error-messages":u.errors.count,autocomplete:"off",onChange:n.checkProductCountFieldComplete},null,8,["modelValue","error-messages","onChange"]),(0,s.bF)(f,{items:n.employees,"item-props":n.employeeProps,"onUpdate:modelValue":n.onSelectEmployee,label:"Монтажник РЭА"},null,8,["items","item-props","onUpdate:modelValue"])])),_:1}),(0,s.bF)(_,null,{default:(0,s.k6)((()=>[(0,s.bF)(v),(0,s.bF)(h,{color:"info",type:"submit"},{default:(0,s.k6)((()=>t[5]||(t[5]=[(0,s.eW)("Создать")]))),_:1,__:[5]}),(0,s.bF)(h,{color:"error",onClick:n.hide},{default:(0,s.k6)((()=>t[6]||(t[6]=[(0,s.eW)("Отменить")]))),_:1,__:[6]},8,["onClick"])])),_:1})])),_:1},8,["onSubmit"])])),_:1})])),_:1},8,["modelValue"])}var u={data(){return{isShow:!1,task:{id:0,productName:"",productsCount:"",productId:0,productionOrderId:0,employeeId:0,employee:null},errors:{productName:"",count:"",employee:""}}},computed:{employees(){return this.$store.getters.employees}},methods:{checkEditingFieldsIsvalid(e){this.resetErrors();let t=!0;return 0===e.productsCount.length&&(this.errors.count="Заполните поле count",t=!1),t},checkProductCountFieldComplete(){this.task.productsCount.length>0&&(this.errors.count="")},checkEmployeeFieldComplete(){this.task.employee?this.errors.employee="":this.errors.employee="Выберите сотрудника"},submitForm(){this.checkEditingFieldsIsvalid(this.task)&&this.$emit("save",this.task)},onSelectEmployee(e){this.task.employeeId=e.id},employeeProps(e){return{title:`${e.lastName} ${e.firstName||""} ${e.middleName||" "}`,subtitle:e.status}},show(e){this.resetErrors(),this.task.productionOrderId=e.id,this.task.productId=e.productId,this.task.productName=`${e.productName||""} (${e.productModel||""})`,this.$store.dispatch("loadEmployees"),this.isShow=!0},hide(){this.isShow=!1},resetErrors(){this.errors={count:"",employee:""}}},emits:["save"]},n=o(1241);const c=(0,n.A)(u,[["render",d]]);var m=c}}]);
//# sourceMappingURL=467.2505dad3.js.map